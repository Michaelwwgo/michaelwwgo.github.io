---
layout: post
title: 5G SS/PBCH Block 设计
categories: 5G_NR
description: 终端初始搜索，就是通过搜索 NR 同步栅格上的SS/PBCH Block 来确定小区。那么，本文将介绍 SS/PBCH Block 具体的时频位置如和确定，以及小区完成搜索过程如何完成初始接入等具体流程。
keywords: SSB, PointA, BWP
---
## BWP（Bandwidth Part）与 CRB（Common RB）

NR 系统带宽相比 LTE 要大得多，最大载波带宽高达 400GHz。而终端显然不可能也没必要支持如此大的带宽。因此，NR 定义了 BWP。BWP 的核心在于定义了一个小于系统工作带宽和不大于终端支持带宽的工作带宽，终端所有的操作都在 BWP 中完成。既实现了终端的省电目的，又可以满足系统调度资源的灵活度。

NR 中把 RB 定义为频域上的 12 个连续的子载波。为了配置 BWP，NR 定义了 CRB。BWP 的时频位置可以通过 RRC 信令配置给终端，而配置 BWP 需要基于一个公共的参考坐标，而 CRB 就是这个频域标尺。CRB 具体使用的 SCS 由 MIB 消息中的 *subCarrierSpacingCommon* 字段给出，该字段取值为 15/30kHz（FR1）或 60/120kHz（FR2）。*subCarrierSpacingCommon* 字段也指出了终端在初始接入时 SIB1，Msg2/4 所使用的 SCS 以及 Paging 和广播系统消息的 SCS。

## Point A 与 kssb

Point A 指的是 CRB0 的子载波 0 的中心频点。因此，不同 SCS 的 CRB0 的中心是对齐的，但是起始边界并不对齐。为了描述 SS/PBCH-block 到 Point A 之间的偏差，即 SIB1 消息中的 *offsetToPointA* 字段， NR 定义了参考 SCS（Reference Subcarrier Spacing for FR1 and FR2）。基于此，NR 给出了参考 PRB。参考 PRB 的 SCS 取值为 15kHz（FR1）或 60kHZ（FR2），如下图所示：

![NR_ResourceBlockIndexing](/images/5G_NR/NR_ResourceBlockIndexing.png)

SS/PBCH-block 的位置是基于 Synchronization Raster 定义的，而 CRB 是基于 Channel Raster 定义的，这两者之间可能存在子载波偏移；此外，SS/PBCH-block 所使用的 SCS 通过 RRC 信令 *ssbSubcarrierSpacing* 字段或者通过盲检来确定 [15/30kHz（FR1）或 120/240kHz（FR2）]。而 CRB 的 SCS 则由字段 *subCarrierSpacingCommon* 给出，这两者 SCS 之间的多种组合造成了 SS/PBCH-block 与 CRB 之间的子载波偏移。为了描述子载波偏移，NR 在 MIB 消息中定义了 *ssb-SubcarrierOffset* 字段，即参数 kssb 来描述子载波偏移。在 FR1，kssb 的取值范围为 0-23，使用的 SCS 为 15kHz；在 FR2，kssb 的取值范围为 0-11，使用的 SCS 由字段 *subCarrierSpacingCommon* 确定。除了指示子载波偏移，kssb 还指示了该 SS/PBCH-block 是否为 Cell-defining SS/PBCH-block，即该 SS/PBCH-block 是否关联了 SIB1 消息。只有通过 Cell-defining SS/PBCH-block，终端才能接入小区。若 kssb 的取值大于 23（FR1）或 11（FR2），该 SS/PBCH-block 为 Non Cell-defining SS/PBCH-block，即没有关联 SIB1 消息。此时，kssb 可以和 MIB 消息中的 *pdcch-ConfigSIB1* 字段联合指示最近的 Cell-defining SS/PBCH-block 的位置。

到此为止，整个确定 SS/PBCH-block 以及 CRB 的过程如下：

1. 首先，终端通过盲检获取定义在 Synchronization Raster 上的 SS/PBCH-block，并通过 NR 预定义的[表格](https://sharetechnote.com/html/5G/5G_FR_Bandwidth.html#38_104_Table_5_4_3_3_1)来获取相应频段范围内 SS/PBCH-block 所使用的 SCS,[15/30kHz（FR1）或 120/240kHz（FR2）]。

2. 根据 *offsetToPointA* 字段确定 Point A 的位置，从而确定 RB $N^{SSB}_{CRB}$ 的位置。RB $N^{SSB}_{CRB}$ 的子载波 0 的中心频点与一个**与 SS/PBCH-block 的 lowest RB 相重叠的 CRB 的子载波 0 的中心频点位置相同**。

3. 通过 kssb 字段确定 SS/PBCH-block 的 lowest RB 子载波 0 与 RB $N^{SSB}_{CRB}$ 的子载波 0 的子载波偏移量。

整个流程可以用下图[^1]来指示：
![NR_k_ssb](/images/5G_NR/NR_k_ssb.png)

[^1]: <https://sharetechnote.com/html/5G/image/NR_k_ssb_01.png>.
